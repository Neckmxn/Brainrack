<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Solutions - Brainrack AI</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="animated-bg"></div>
    <header>
        <div class="header-content">
            <a href="/dashboard" class="logo"><span>ğŸ§ </span> Brainrack AI</a>
            <nav class="nav-actions">
                <a href="/dashboard" class="btn btn-secondary">Dashboard</a>
                <div class="menu-container">
                    <button class="icon-btn" id="menuBtn"><span>â‹®</span></button>
                    <div class="menu-dropdown" id="menuDropdown">
                        <a href="/dashboard" class="menu-item"><span>ğŸ </span> Dashboard</a>
                        <a href="/chat" class="menu-item"><span>ğŸ’¬</span> AI Chat</a>
                        <a href="/image" class="menu-item"><span>ğŸ¨</span> Image Generator</a>
                        <a href="/document" class="menu-item"><span>ğŸ“„</span> Document Analyzer</a>
                        <a href="/video" class="menu-item"><span>ğŸ¥</span> Video Generator</a>
                        <a href="/business" class="menu-item"><span>ğŸ’¼</span> Business Solutions</a>
                        <a href="/startup" class="menu-item"><span>ğŸš€</span> Startup Ideas</a>
                        <a href="/news" class="menu-item"><span>ğŸ“°</span> News</a>
                        <a href="/weather" class="menu-item"><span>â›…</span> Weather</a>
                        <a href="/contact" class="menu-item"><span>ğŸ“§</span> Contact Us</a>
                        <div class="menu-item" id="profileBtn"><span>ğŸ‘¤</span> Profile</div>
                        <div class="menu-item" id="themeToggle"><span>ğŸŒ“</span> Toggle Theme</div>
                        <div class="menu-item" id="settingsBtn"><span>âš™ï¸</span> Settings</div>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main class="container">
        <div class="chat-container">
            <div class="chat-messages" id="chatMessages">
                <div class="message assistant">
                    <div class="message-avatar">AI</div>
                    <div class="message-content">
                        Hello! I'm your AI Business Consultant. I can help you with:
                        <br>â€¢ Strategic Planning
                        <br>â€¢ Market Analysis
                        <br>â€¢ Financial Planning
                        <br>â€¢ Operations Optimization
                        <br>â€¢ Marketing Strategies
                        <br>â€¢ Problem Solving
                        <br><br>What business challenge can I help you with today?
                    </div>
                </div>
            </div>

            <div class="chat-input-container">
                <textarea id="chatInput" class="chat-input" placeholder="Describe your business problem..." rows="1"></textarea>
                <div class="input-actions">
                    <button class="send-btn" id="sendBtn">â¤</button>
                </div>
            </div>
        </div>
    </main>

    <script src="script.js"></script>
    <script>
        const chatMessages = document.getElementById('chatMessages');
        const chatInput = document.getElementById('chatInput');
        const sendBtn = document.getElementById('sendBtn');
        let conversationHistory = [
            { role: 'system', content: 'You are an expert business consultant with MBA-level knowledge. Provide strategic, actionable advice for business problems including operations, marketing, finance, HR, and strategy. Be specific and data-driven in your recommendations.' }
        ];

        chatInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
        sendBtn.addEventListener('click', sendMessage);

        async function sendMessage() {
            const message = chatInput.value.trim();
            if (!message) return;

            addMessage(message, 'user');
            chatInput.value = '';
            conversationHistory.push({ role: 'user', content: message });

            const typingIndicator = addTypingIndicator();

            try {
                const response = await fetch('/api/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ messages: conversationHistory })
                });

                const data = await response.json();
                typingIndicator.remove();

                const aiResponse = data.choices[0].message.content;
                conversationHistory.push({ role: 'assistant', content: aiResponse });
                await addMessageWithTyping(aiResponse, 'assistant');

            } catch (error) {
                typingIndicator.remove();
                addMessage('Error: ' + error.message, 'assistant');
            }
        }

        function addMessage(text, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            messageDiv.innerHTML = `
                <div class="message-avatar">${sender === 'user' ? 'You' : 'AI'}</div>
                <div class="message-content">${text}</div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        async function addMessageWithTyping(text, sender) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            const content = document.createElement('div');
            content.className = 'message-content';
            messageDiv.innerHTML = `<div class="message-avatar">${sender === 'user' ? 'You' : 'AI'}</div>`;
            messageDiv.appendChild(content);
            chatMessages.appendChild(messageDiv);

            for (let i = 0; i < text.length; i++) {
                content.textContent += text[i];
                chatMessages.scrollTop = chatMessages.scrollHeight;
                await new Promise(resolve => setTimeout(resolve, 10));
            }
        }

        function addTypingIndicator() {
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message assistant';
            messageDiv.innerHTML = `
                <div class="message-avatar">AI</div>
                <div class="message-content">
                    <div class="typing-indicator">
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                        <div class="typing-dot"></div>
                    </div>
                </div>
            `;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            return messageDiv;
        }
    </script>
</body>
</html>